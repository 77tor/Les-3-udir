<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Udir-kart-Les-3.trinn</title>
<link rel="icon" type="image/png" href="LES.png">
<link rel="apple-touch-icon" href="LES.png">
    <style>

/* Startside-stil */
#start-page {
    text-align: left;
    max-width: 800px;
    margin: 50px auto;
    padding: 30px;
    background: white;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}

#start-page h1 { color: #2980b9; text-align: center; }

.start-info {
    font-size: 1.1rem;
    line-height: 1.6;
    margin: 20px 0;
}

.start-btn {
    display: block;
    width: 250px;
    margin: 30px auto;
    padding: 20px;
    background-color: #2ecc71;
    color: white;
    border: none;
    border-radius: 50px;
    font-size: 1.5rem;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.2s;
}

.start-btn:hover { transform: scale(1.05); background-color: #27ae60; }

        html, body { margin: 0; padding: 0; width: 100%; overflow-x: hidden; height: 100%; }
        body { font-family: sans-serif; text-align: center; background: #f4f4f9; padding: 10px; box-sizing: border-box; padding-bottom: 120px; }
        .container { width: 98%; max-width: 1400px; margin: 10px auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); box-sizing: border-box; }
        
        /* Instruksjonsfelt */
        .instruction-section { margin-bottom: 25px; background: #f8f9fa; padding: 20px; border-radius: 10px; border: 1px solid #ddd; display: flex; flex-direction: column; align-items: center; gap: 15px; }
#textDisplay { 
    font-size: 1.1rem; /* Gjort litt mindre (fra 1.3rem) */
    line-height: 1.4; 
    color: #000000; /* Helt sort tekst */
    font-weight: normal;
}

/* Spesifikk justering for den store teksten i oppgave 11 og 12 */
.audio-choice-text { 
    font-size: 1.6rem !important; /* Redusert betydelig (fra 2.2rem) */
    font-weight: bold; 
    color: #000000 !important; /* Endret fra bl√• til sort */
    margin-top: 10px; 
}
        audio { width: 100%; max-width: 450px; transform: scale(1.1); }
        .image-container { position: relative; display: inline-block; width: 100%; cursor: crosshair; }
        img.main-img { width: 100%; height: auto; border: 2px solid #333; border-radius: 5px; }
        
        /* Bilder */
        .support-img { max-width: 400px; width: 80%; height: auto; margin-bottom: 20px; border-radius: 8px; border: 1px solid #ccc; }
        .support-img.large { max-width: 800px; width: 95%; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }

        /* Knapper og rutenett */
        .options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px; }
        .opt-btn { padding: 15px; cursor: pointer; border: 2px solid #ddd; border-radius: 12px; background: white; font-size: 1.2rem; transition: 0.2s; }
        .opt-btn.selected { border-color: #3498db; background: #ebf5fb; box-shadow: 0 0 10px rgba(52, 152, 219, 0.3); }
        
        #click-marker { position: absolute; width: 40px; height: 40px; border: 3px solid #ff0000; box-shadow: 0 0 0 2px white, 0 0 10px rgba(0,0,0,0.5); border-radius: 50%; background: rgba(255, 0, 0, 0.2); pointer-events: none; transform: translate(-50%, -50%); display: none; z-index: 999; }

        /* Flashword spesifikk */
        #flash-container { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 20px; margin: 20px auto; }
        .flash-box { width: 300px; height: 120px; border: 3px dashed #3498db; border-radius: 15px; display: flex; align-items: center; justify-content: center; background: #fff; }
        .flash-btn { padding: 15px 30px; font-size: 1.3rem; background-color: #2ecc71; color: white; border: none; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 10px; }
        .flash-btn:disabled { background-color: #95a5a6; cursor: not-allowed; }
        .flash-word-display { font-size: 3.5rem; font-weight: bold; color: #e74c3c; margin: 0; }

        /* Typing */
        .typing-container { margin: 20px auto; max-width: 500px; }
        .word-input { width: 100%; padding: 15px; font-size: 1.5rem; border: 3px solid #3498db; border-radius: 10px; text-align: center; }
        
        /* Navigasjon */
/* Navigasjon - Justert for iPad/Smalere skjermer */
.nav-footer { 
    position: fixed; 
    bottom: 0; 
    left: 0; 
    width: 100%; 
    background: white; 
    padding: 10px 5px; /* Redusert padding p√• sidene */
    box-shadow: 0 -4px 15px rgba(0,0,0,0.1); 
    z-index: 1000; 
}

.nav-inner { 
    max-width: 1200px; 
    margin: 0 auto; 
    display: flex; 
    align-items: center; 
    justify-content: center; /* Sentrerer alt innhold */
    gap: 10px; /* Mindre mellomrom mellom knapper og tall */
}

.dots-container { 
    display: flex; 
    justify-content: center; 
    gap: 4px; /* Tettere mellomrom mellom tallene */
    flex-wrap: nowrap; /* Tvinger dem til √• pr√∏ve √• st√• p√• √©n linje */
}

.dot { 
    width: 30px; /* Litt mindre sirkler (fra 35px) */
    height: 30px; 
    border-radius: 50%; 
    border: 1px solid #ccc; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    cursor: pointer; 
    background: white; 
    font-weight: bold; 
    font-size: 0.9rem; /* Litt mindre tekst */
    flex-shrink: 1; /* Lar sirklene krympe litt hvis n√∏dvendig */
}

.btn-nav { 
    padding: 10px 15px; /* Litt smalere knapper */
    cursor: pointer; 
    border: none; 
    border-radius: 8px; 
    color: white; 
    min-width: 80px; /* Redusert min-bredde */
    font-weight: bold; 
    font-size: 0.9rem;
}
        .dot.active { background: #3498db; color: white; border-color: #2980b9; }
        .dot.completed { background: #ecf0f1; border-color: #7f8c8d; }
        #prevBtn { background: #95a5a6; }
        #nextBtn { background: #2ecc71; }

        /* Split Screen (Oppgave 16) */
        .split-container { display: flex; flex-direction: row; gap: 20px; align-items: flex-start; text-align: left; margin-top: 10px; }
        .split-image { flex: 4; }
        .split-image img { width: 100%; height: auto; border-radius: 10px; border: 2px solid #333; }
        .split-questions { flex: 1; display: flex; flex-direction: column; gap: 10px; }
        .split-questions h2 { font-size: 1.1rem !important; margin-bottom: 10px; color: #000000; }
        .split-questions .opt-btn { padding: 10px; font-size: 1rem; width: 100%; text-align: left; }

        .hidden { display: none !important; }
        .invisible { visibility: hidden; opacity: 0; }

        /* Resultatside */
        .summary-item { padding: 15px; margin-bottom: 10px; border-radius: 8px; text-align: left; }
        .res-correct { background: #e8f8f5; border: 1px solid #2ecc71; color: #27ae60; }
        .res-wrong { background: #fdedec; border: 1px solid #e74c3c; color: #c0392b; }
    </style>
</head>
<body>

<div id="start-page" class="container">
    <h1>N√• skal vi √∏ve p√• kartleggingspr√∏ve! üìñ</h1>
    <div class="start-info">
        <div style="background: #ebf5fb; padding: 15px; border-radius: 10px; border: 1px solid #3498db; margin-bottom: 20px; text-align: center;">
            <p style="margin-top: 0;"><strong>F√∏rst: Sjekk at du har lyd i √∏reklokkene</strong></p>
            <button class="opt-btn" onclick="new Audio('test.mp3').play()" style="background: #3498db; color: white; border: none; padding: 10px 20px;">
                üîä Trykk her for √• teste lyden
            </button>
            <p style="font-size: 0.9rem; margin-bottom: 0; color: #555;">H√∏rer du noen som snakker?</p>
        </div>

        <p>Hei! I denne pr√∏ven skal du l√∏se forskjellige oppgaver:</p>
        <ul>
            <li>üéß <strong>Lytt:</strong> Trykk p√• play-knappen for √• h√∏re oppgaven.</li>
            <li>‚ö° <strong>Flashword:</strong> Noen ord vises veldig raskt. F√∏lg godt med i ruta!</li>
            <li>üîç <strong>Finn sted i bilde:</strong> Trykk p√• riktig sted i bildet.</li>
            <li>‚å®Ô∏è <strong>Skriv:</strong> Skriv ordet som passer til teksten som lese opp/bildet som vises.</li>
        </ul>
    </div>
    <button class="start-btn" onclick="startQuiz()">Start n√• ‚ñ∂</button>
</div>


<div id="quiz-wrap" class="container hidden">
    <div class="instruction-section" id="inst-sec">
        <audio id="audioPlayer" controls></audio>
        <div id="textDisplay" class="hidden"></div>
    </div>

    <div id="support-image-container">
        <img id="supportImage" class="support-img hidden" src="" alt="St√∏ttebilde">
    </div>

    <div id="hotspot-area" class="image-container hidden">
        <img src="" alt="" id="taskImage" class="main-img">
        <div id="click-marker"></div>
    </div>

    <div id="flash-container" class="hidden">
        <div class="flash-box">
            <div id="wordFlashDisplay" class="flash-word-display"></div>
        </div>
        <button id="showWordBtn" class="flash-btn" onclick="startFlash()"><span>‚ñ∂</span> Vis ordet</button>
    </div>

    <div id="typing-area" class="typing-container hidden">
        <input type="text" id="wordInputField" class="word-input" placeholder="Skriv ordet her..." autocomplete="off" oninput="saveTyping()">
    </div>

    <div id="options-area" class="options-grid hidden"></div>

    <div class="nav-footer">
        <div class="nav-inner">
            <button class="btn-nav" id="prevBtn" onclick="changeTask(-1)">Forrige</button>
            <div class="dots-container" id="dots"></div>
            <button class="btn-nav" id="nextBtn">Neste</button>
        </div>
    </div>
</div>

<div id="result-page" class="container hidden">
    <h1>Resultat</h1>
    <h2 id="final-score"></h2>
    <div id="summary-list"></div>
    <br>
    <button class="btn-nav" style="background: #3498db;" onclick="location.reload()">Start p√• nytt</button>
</div>

<script>
    const taskData = [
        { id: 1, type: 'choice', audio: "01.mp3", supportImg: "01.png", options: ["dage", "drag", "brage", "drage"], correct: 3 },
        { id: 2, type: 'choice', audio: "02.mp3", supportImg: "02.png", options: ["tet", "tell", "telt", "talt"], correct: 2 },
        { id: 3, type: 'flashword', word: "sol", options: ["sol", "sal", "sel", "s√∏l"], correct: 0 },
        { id: 4, type: 'flashword', word: "dag", options: ["dag", "deg", "bag", "dal"], correct: 0 },
        { id: 5, type: 'typing', audio: "05.mp3", supportImg: "05.png", correct: ["gitar"] },
        { id: 6, type: 'typing', audio: "06.mp3", supportImg: "06.png", correct: ["kake"] },
        { id: 7, type: 'hotspot', img: "07.png", audio: "07.mp3", target: { xMin: 71, xMax: 76, yMin: 4, yMax: 15 } },
        { id: 8, type: 'hotspot', img: "08.png", audio: "08.mp3", target: { xMin: 0, xMax: 30, yMin: 48, yMax: 67 } },
        { id: 9, type: 'choice', audio: "09.mp3", options: ["09_01.png", "09_02.png", "09_03.png", "09_04.png"], correct: 0, isImage: true },
        { id: 10, type: 'choice', audio: "10.mp3", options: ["10_01.png", "10_02.png", "10_03.png", "10_04.png"], correct: 3, isImage: true },
        { 
            id: 11, type: 'audio-choice', textInstruction: "Far liker √• padle p√• sj√∏en.", audio: "11.mp3", 
            options: [{ text: "se", audio: "11_01.mp3" }, { text: "seile", audio: "11_02.mp3" }, { text: "ro", audio: "11_03.mp3" }, { text: "hoppe", audio: "11_04.mp3" }], correct: 2 
        },
        { 
            id: 12, type: 'audio-choice', textInstruction: "Katten balanserer p√• gjerdet.", audio: "12.mp3", 
            options: [{ text: "g√•r", audio: "12_01.mp3" }, { text: "ser", audio: "12_02.mp3" }, { text: "faller", audio: "12_03.mp3" }, { text: "slikker", audio: "12_04.mp3" }], correct: 0 
        },
        { id: 13, type: 'choice', textInstruction: "Pia leser ei bok i senga.", options: ["13_01.png", "13_02.png", "13_03.png", "13_04.png"], correct: 1, isImage: true },
        { id: 14, type: 'choice', textInstruction: "Ali bader i bassenget.", options: ["14_01.png", "14_02.png", "14_03.png", "14_04.png"], correct: 2, isImage: true },
        { id: 15, type: 'choice', textInstruction: "Sauene g√•r ute om sommeren. Lammet drikker melk fra mammaen sin.", options: ["15_01.png", "15_02.png", "15_03.png", "15_04.png"], correct: 3, isImage: true },
        { 
            id: 16, type: 'split-screen', img: "16.png", textInstruction: "Hva vil Massimiliano bli n√•r han blir stor?", 
            options: ["fotograf", "fotballkeeper", "paleontolog", "astronaut"], correct: 0 
        }
    ];

    let currentIdx = 0;
    let userChoices = new Array(taskData.length).fill(null);
    let wordsShown = [];

    function loadTask() {
        const task = taskData[currentIdx];
        const player = document.getElementById('audioPlayer');
        const textDisplay = document.getElementById('textDisplay');
        const instSec = document.getElementById('inst-sec');
        const supportImage = document.getElementById('supportImage');
        const flashContainer = document.getElementById('flash-container');
        const hotspotArea = document.getElementById('hotspot-area');
        const optionsArea = document.getElementById('options-area');
        const typingArea = document.getElementById('typing-area');
        const inputField = document.getElementById('wordInputField');
        const marker = document.getElementById('click-marker');

        window.scrollTo(0,0);
        player.onended = null;
        
        // NULLSTILLING: Fjerner klasser som kan henge igjen
        supportImage.classList.remove('large');
        optionsArea.classList.add('options-grid');
        instSec.classList.remove('hidden');

        [flashContainer, hotspotArea, optionsArea, typingArea, supportImage, player, textDisplay].forEach(el => {
            el.classList.add('hidden');
            el.classList.remove('invisible');
        });
        if(marker) marker.style.display = "none";

        // Lyd og tekstinstruksjoner
        if (task.audio) {
            player.classList.remove('hidden');
            player.src = task.audio;
            player.load();
        } 
        if (task.textInstruction && task.type !== 'split-screen') {
            textDisplay.classList.remove('hidden');
            textDisplay.innerText = task.textInstruction;
            if(task.type === 'audio-choice') textDisplay.classList.add('audio-choice-text');
        }

        // H√•ndtering av oppgavetyper
        if (task.type === 'split-screen') {
            instSec.classList.add('hidden');
            optionsArea.classList.remove('hidden', 'options-grid');
            optionsArea.innerHTML = `
                <div class="split-container">
                    <div class="split-image"><img src="${task.img}"></div>
                    <div class="split-questions" id="split-opts">
                        <h2>${task.textInstruction}</h2>
                    </div>
                </div>`;
            const splitOpts = document.getElementById('split-opts');
            task.options.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = "opt-btn " + (userChoices[currentIdx] === idx ? 'selected' : '');
                btn.innerText = opt;
                btn.onclick = () => { userChoices[currentIdx] = idx; loadTask(); updateNav(); };
                splitOpts.appendChild(btn);
            });
        } 
        else if (task.type === 'flashword') {
            flashContainer.classList.remove('hidden');
            optionsArea.classList.remove('hidden');
            const showBtn = document.getElementById('showWordBtn');
            const flashDisplay = document.getElementById('wordFlashDisplay');
            flashDisplay.innerText = "";

            if (wordsShown.includes(task.id)) {
                showBtn.disabled = true;
                showBtn.innerHTML = "Allerede vist";
                optionsArea.classList.remove('invisible');
            } else {
                showBtn.disabled = false;
                showBtn.innerHTML = "<span>‚ñ∂</span> Vis ordet";
                optionsArea.classList.add('invisible');
            }
            renderOptions(task);
        }
        else if (task.type === 'hotspot') {
            hotspotArea.classList.remove('hidden');
            document.getElementById('taskImage').src = task.img;
            if (userChoices[currentIdx]) {
                marker.style.left = userChoices[currentIdx].x + "%";
                marker.style.top = userChoices[currentIdx].y + "%";
                marker.style.display = "block";
            }
        } 
        else if (task.type === 'typing') {
            supportImage.src = task.supportImg;
            supportImage.classList.remove('hidden');
            supportImage.classList.add('large');
            typingArea.classList.remove('hidden');
            inputField.value = userChoices[currentIdx] || "";
            setTimeout(() => inputField.focus(), 100);
        } 
        else if (task.type === 'audio-choice') {
            optionsArea.classList.remove('hidden');
            optionsArea.classList.add('invisible');
            player.onended = () => optionsArea.classList.remove('invisible');
            renderAudioOptions(task);
        }
        else {
            if (task.supportImg) { 
                supportImage.src = task.supportImg; 
                supportImage.classList.remove('hidden'); 
            }
            optionsArea.classList.remove('hidden');
            renderOptions(task);
        }
        updateNav();
    }

    function startFlash() {
        const task = taskData[currentIdx];
        if (wordsShown.includes(task.id)) return;
        wordsShown.push(task.id);
        
        const btn = document.getElementById('showWordBtn');
        btn.disabled = true;
        btn.innerHTML = "Viser...";
        
        document.getElementById('wordFlashDisplay').innerText = task.word;
        
        setTimeout(() => {
            document.getElementById('wordFlashDisplay').innerText = "";
            document.getElementById('options-area').classList.remove('invisible');
            btn.innerHTML = "Allerede vist";
        }, 1500); // 1.5 sekunder
    }

    function renderOptions(task) {
        const area = document.getElementById('options-area');
        area.innerHTML = "";
        task.options.forEach((opt, idx) => {
            const btn = document.createElement('button');
            btn.className = "opt-btn " + (userChoices[currentIdx] === idx ? 'selected' : '');
            btn.innerHTML = task.isImage ? `<img src="${opt}" style="width:100%;">` : opt;
            btn.onclick = () => { userChoices[currentIdx] = idx; renderOptions(task); updateNav(); };
            area.appendChild(btn);
        });
    }

    function renderAudioOptions(task) {
        const area = document.getElementById('options-area');
        area.innerHTML = "";
        task.options.forEach((opt, idx) => {
            const container = document.createElement('div');
            container.className = "opt-btn " + (userChoices[currentIdx] === idx ? 'selected' : '');
            container.style.display = "flex"; container.style.justifyContent = "space-between";
            container.innerHTML = `<span style="flex-grow:1; text-align:left; font-weight:bold;">${opt.text}</span>`;
            container.onclick = () => { userChoices[currentIdx] = idx; renderAudioOptions(task); updateNav(); };
            
            const audioBtn = document.createElement('button');
            audioBtn.innerHTML = "üîä";
            audioBtn.style.cssText = "background:#3498db; color:white; border:none; border-radius:50%; width:40px; height:40px; cursor:pointer;";
            audioBtn.onclick = (e) => { e.stopPropagation(); new Audio(opt.audio).play(); };
            
            container.appendChild(audioBtn);
            area.appendChild(container);
        });
    }

    document.getElementById('hotspot-area').onclick = function(e) {
        if (taskData[currentIdx].type !== 'hotspot') return;
        const rect = this.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * 100;
        const y = ((e.clientY - rect.top) / rect.height) * 100;
        userChoices[currentIdx] = { x, y };
        loadTask();
    };

    function saveTyping() { userChoices[currentIdx] = document.getElementById('wordInputField').value; updateNav(); }

function updateNav() {
    const dots = document.getElementById('dots'); 
    dots.innerHTML = "";
    taskData.forEach((_, i) => {
        const isComp = userChoices[i] !== null && userChoices[i] !== "";
        const d = document.createElement('div');
        d.className = `dot ${i === currentIdx ? 'active' : ''} ${isComp ? 'completed' : ''}`;
        d.innerText = i + 1; 
        d.onclick = () => { currentIdx = i; loadTask(); };
        dots.appendChild(d);
    });

    // Kontroll for Forrige-knapp
    document.getElementById('prevBtn').onclick = () => changeTask(-1);
    document.getElementById('prevBtn').disabled = currentIdx === 0;
    
    // Kontroll for Neste/Lever-knapp
    const nextBtn = document.getElementById('nextBtn');
    if (currentIdx === taskData.length - 1) {
        nextBtn.innerText = "Lever";
        nextBtn.onclick = function() {
            console.log("Lever trykket - viser resultater"); // Debug-linje
            showResults();
        };
    } else {
        nextBtn.innerText = "Neste";
        nextBtn.onclick = function() {
            changeTask(1);
        };
    }
}

function changeTask(step) {
    let newIdx = currentIdx + step;
    if (newIdx >= 0 && newIdx < taskData.length) {
        currentIdx = newIdx;
        loadTask();
    }
}

    function showResults() {
        document.getElementById('quiz-wrap').classList.add('hidden');
        document.getElementById('result-page').classList.remove('hidden');
        let score = 0;
        const list = document.getElementById('summary-list');
        list.innerHTML = "";

        taskData.forEach((task, i) => {
            let isCorrect = false; let displaySvar = "Ikke besvart"; let svar = userChoices[i];
            if (svar !== null && svar !== "") {
                if (task.type === 'hotspot') { isCorrect = (svar.x >= task.target.xMin && svar.x <= task.target.xMax && svar.y >= task.target.yMin && svar.y <= task.target.yMax); displaySvar = "Markert i bilde"; }
                else if (task.type === 'typing') { isCorrect = task.correct.some(f => f.toLowerCase() === svar.trim().toLowerCase()); displaySvar = svar; }
                else if (task.type === 'audio-choice') { isCorrect = (svar === task.correct); displaySvar = task.options[svar].text; }
                else { isCorrect = (svar === task.correct); displaySvar = task.isImage ? `Bilde nr ${svar + 1}` : task.options[svar]; }
            }
            if (isCorrect) score++;
            list.innerHTML += `<div class="summary-item ${isCorrect ? 'res-correct' : 'res-wrong'}"><strong>Oppgave ${i+1}:</strong> ${isCorrect ? 'Riktig ‚úÖ' : 'Feil ‚ùå'} <br><small>Ditt svar: ${displaySvar}</small></div>`;
        });
        document.getElementById('final-score').innerText = `Du fikk ${score} av ${taskData.length} riktige!`;
    }

function startQuiz() {
    document.getElementById('start-page').classList.add('hidden');
    document.getElementById('quiz-wrap').classList.remove('hidden');
    loadTask(); // N√• starter vi oppgavene
}
</script>
</body>
</html>